namespace = CrisisManagerMenu

#################################
#################################
#####						#####
#####	Crisis Manager		#####
#####						#####
#####	Manual Operations	#####
#####						#####
#################################
#################################

###################
###- Main Menu -###
###################

country_event = {
	id = CrisisManagerMenu.7000
	title = CrisisManagerMenu.7000.name
	desc = CrisisManagerMenu.7000.desc
	picture = GFX_evt_CmtMenuA
	is_triggered_only = yes

	immediate = {
		# Possible flag fix (to be sure) - sometimes not removed.
		if = {
			limit = {
				host_has_dlc = "Apocalypse"
				has_global_flag = CmtFlagMidGameEdition
				has_global_flag = marauder_crisis_ongoing
				CmtTriggerNowInKhanCrisis = no
			}
			remove_global_flag = marauder_crisis_ongoing
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Trigger End-Game Crisis
	option = {
		name = CrisisManagerMenu.7000.7110.A.name
		custom_tooltip = CrisisManagerMenu.7000.7110.A.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			NAND = {
				has_global_flag = galactic_crisis_happened
				CmtTriggerForbiddenPrethoryn = yes
				has_global_flag = sentinels_founded
				CmtTriggerForbiddenExds = yes
				has_global_flag = extradimensional_second_portal
				has_global_flag = extradimensional_third_portal
				CmtTriggerForbiddenContingency = yes
				has_global_flag = cybrex_resurface
				CmtTriggerForbiddenForcedEoc = yes
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.7000.7110.B.name
		custom_tooltip = CrisisManagerMenu.7000.B.7110.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			has_global_flag = galactic_crisis_happened
			CmtTriggerForbiddenPrethoryn = yes
			has_global_flag = sentinels_founded
			CmtTriggerForbiddenExds = yes
			has_global_flag = extradimensional_second_portal
			has_global_flag = extradimensional_third_portal
			CmtTriggerForbiddenContingency = yes
			has_global_flag = cybrex_resurface
			CmtTriggerForbiddenForcedEoc = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}

	### Trigger Awakening of Sleeper
	option = {
		name = CrisisManagerMenu.7000.7135.A.name
		custom_tooltip = CrisisManagerMenu.7000.7135.A.tooltip
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			any_country = { CmtTriggerIsOrganicSleeper = yes }
		}
		allow = { mid_game_years_passed >= 40 }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7135 } }
	}
	option = {
		name = CrisisManagerMenu.7000.7135.B.name
		custom_tooltip = CrisisManagerMenu.7000.7135.B.tooltip
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			NOT = { any_country = { CmtTriggerIsOrganicSleeper = yes } }
		}
		allow = { mid_game_years_passed >= 40 }
		hidden_effect = {
			if = { limit = { mid_game_years_passed >= 40 }
				country_event = { id = CrisisManagerMenu.7135 }
			} else = { country_event = { id = CrisisManagerMenu.7000 } }
		}
	}

	### War in Heaven
	option = {
		name = CrisisManagerMenu.7000.7136.A.name
		custom_tooltip = CrisisManagerMenu.7000.7136.A.tooltip
		allow = {
			has_leviathans = yes
			OR = {
				NOT = { has_country_flag = war_in_heaven_timer }	## Moratorium Term
				has_global_flag = war_in_heaven_debug
				event_target:CmtGlobalVar = { check_variable = { which = CmtVarHeavenPreludeSpeed value = 4 } }
			}
		}
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			count_country = {
				count > 1
				limit = {
					is_fallen_empire = yes
					CmtTriggerIsHeavenAFE = no
					is_at_war = no
				}
			}
			# NOR = {
			# 	has_global_flag = CmtFlagWarInHeavenTriggered
			# 	count_country = { limit = { CmtTriggerIsAwakenableSleeper = yes } count < 2 }
			# }
		}
		hidden_effect = {
			if = { limit = { exists = event_target:CmtTargetManualSleeperA }
				clear_global_event_target = CmtTargetManualSleeperA
			}
			if = { limit = { exists = event_target:CmtTargetManualSleeperB }
				clear_global_event_target = CmtTargetManualSleeperB
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}
	option = {
		name = CrisisManagerMenu.7000.7136.B.name
		custom_tooltip = CrisisManagerMenu.7000.7136.B.tooltip
		allow = { has_leviathans = yes }
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			OR = {
				has_country_flag = war_in_heaven_timer
				count_country = {
					count < 2
					limit = {
						is_fallen_empire = yes
						CmtTriggerIsHeavenAFE = no
						is_at_war = no
					}
				}
			}
			# count_country = { limit = { CmtTriggerIsOrganicSleeper = yes } count < 2 }
		}
		hidden_effect = {
			if = {
				limit = { # Hidden fallback
					OR = {
						has_global_flag = war_in_heaven_debug
						count_country = {
							count > 1
							limit = {
								is_fallen_empire = yes
								is_at_war = no
							}
						}
					}
				}
				country_event = { id = CrisisManagerMenu.7136 }
			} else = { country_event = { id = CrisisManagerMenu.7000 } }
		}
	}
	# option = {
	# 	name = CrisisManagerMenu.7000.7136.C.name
	# 	custom_tooltip = CrisisManagerMenu.7000.7136.C.tooltip
	# 	allow = { has_leviathans = yes }
	# 	trigger = {
	# 		has_global_flag = CmtFlagSleeperEdition
	# 		has_global_flag = CmtFlagWarInHeavenTriggered
	# 		NOT = { count_country = { limit = { CmtTriggerIsOrganicSleeper = yes } count < 2 } }
	# 	}
	# 	hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	# }

	### Khan
	option = { # valid
		name = CrisisManagerMenu.7000.7138.A.name
		custom_tooltip = CrisisManagerMenu.7000.7138.A.tooltip
		allow = { host_has_dlc = "Apocalypse" }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			NOT = { has_global_flag = marauder_crisis_ongoing }
			# CmtTriggerNowInKhanCrisis = no
			OR = {
				has_global_flag = marauder_crisis_started # Possible fallback
				any_country = { CmtTriggerHasPotentialKhanAwaking = yes }
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7138 } }
	}
	option = { # Not possible (not ongoing)
		name = CrisisManagerMenu.7000.7138.B.name
		custom_tooltip = CrisisManagerMenu.7000.7138.B.tooltip
		allow = { host_has_dlc = "Apocalypse" }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			NOR = {
				has_global_flag = marauder_crisis_ongoing
				has_global_flag = marauder_crisis_started # Possible fallback
				any_country = { CmtTriggerHasPotentialKhanAwaking = yes }
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = { # Possible (but ongoing)
		name = CrisisManagerMenu.7000.7138.C.name
		custom_tooltip = CrisisManagerMenu.7000.7138.C.tooltip
		allow = { host_has_dlc = "Apocalypse" }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			has_global_flag = marauder_crisis_ongoing
			# CmtTriggerNowInKhanCrisis = yes
			# any_country = { CmtTriggerHasPotentialKhanAwaking = yes }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}

	### L-Gate
	option = {
		name = CrisisManagerMenu.7000.7140.A.name
		custom_tooltip = CrisisManagerMenu.7000.7140.A.tooltip
		allow = { has_distar = yes }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			any_megastructure = { CmtTriggerIsClosedLgate = yes }
			NOT = { has_global_flag = l_cluster_opened }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7140 } }
	}
	option = {
		name = CrisisManagerMenu.7000.7140.B.name
		custom_tooltip = CrisisManagerMenu.7000.7140.B.tooltip
		allow = { has_distar = yes }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			NOR = {
				has_global_flag = l_cluster_opened
				any_megastructure = { CmtTriggerIsClosedLgate = yes }
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CrisisManagerMenu.7000.7140.C.name
		custom_tooltip = CrisisManagerMenu.7000.7140.C.tooltip
		allow = { has_distar = yes }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			has_global_flag = l_cluster_opened
			NOT = { any_megastructure = { CmtTriggerIsClosedLgate = yes } }
		}
		hidden_effect = {
			if = {
				limit = {
					any_megastructure = { CmtTriggerIsOpenedLgate = yes }
					NOT = { has_global_flag = CmtFlagLgateOpenedNow }
				}
				country_event = { id = CrisisManagerMenu.7140 }
			} else = { country_event = { id = CrisisManagerMenu.7000 } }
		}
	}
	option = {
		name = CrisisManagerMenu.7000.7142.name
		custom_tooltip = CrisisManagerMenu.7000.7142.tooltip
		allow = { has_distar = yes }
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			has_global_flag = l_cluster_opened
			any_megastructure = { CmtTriggerIsClosedLgate = yes }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7142 } }
	}

	### Uprising
	# option = {
	#	name = CrisisManagerMenu.7000.7146.A.name
	#	custom_tooltip = CrisisManagerMenu.7000.7146.A.tooltip
	#	trigger = {
	#		has_synthethic_dawn = yes
	#		has_global_flag = CmtFlagUprisingEdition
	#		any_country = { CmtTriggerUprisingPotentialManually = yes }
	#	}
	#	hidden_effect = { country_event = { id = CrisisManagerMenu.7146 } }
	#}
	# option = {
	#	name = CrisisManagerMenu.7000.7146.B.name
	#	custom_tooltip = CrisisManagerMenu.7000.7146.B.tooltip
	#	trigger = {
	#		has_synthethic_dawn = yes
	#		has_global_flag = CmtFlagUprisingEdition
	#		NOT = { any_country = { CmtTriggerUprisingPotentialManually = yes } }
	#	}
	#	hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	#}

	### Player Crisis
	option = {
		name = CrisisManagerMenu.7000.7150.A.name
		custom_tooltip = CrisisManagerMenu.7000.7150.A.tooltip
		trigger = {
			has_global_flag = CmtFlagPlayerCrisisPatch
			NOR = {
				exists = event_target:OriginalCountry
				exists = event_target:CmtTargetPlayerCrisisAggressor
			}
			any_country = { CmtTriggerPlayerCrisisAggressorCandidateMenu = yes }
			any_country = { CmtTriggerPlayerCrisisDefenceLeaderCandidate = yes }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7150 } }
	}
	option = {
		name = CrisisManagerMenu.7000.7150.B.name
		custom_tooltip = CrisisManagerMenu.7000.7150.B.tooltip
		trigger = {
			has_global_flag = CmtFlagPlayerCrisisPatch
			OR = {
				exists = event_target:OriginalCountry
				exists = event_target:CmtTargetPlayerCrisisAggressor
				NAND = {
					any_country = { CmtTriggerPlayerCrisisAggressorCandidateMenu = yes }
					any_country = { CmtTriggerPlayerCrisisDefenceLeaderCandidate = yes }
				}
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			NOT = { has_global_flag = CmtFlagNoSeparator }
			OR = {
				has_global_flag = CmtFlagSleeperEdition
				has_global_flag = CmtFlagMidGameEdition
			}
		}
		allow = { hidden_trigger = { always = no } }
	}

	### Terminate Eng-Game Crisis
	option = {
		name = CrisisManagerMenu.7000.7200.name
		custom_tooltip = CrisisManagerMenu.7000.7200.tooltip
		trigger = {
			OR = {
				has_global_flag = CmtFlagEndGameEdition
				has_global_flag = CmtFlagMidGameEdition
				has_global_flag = CmtFlagSleeperEdition
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}

	### Create Fleet for Sleeper
	option = {
		name = CrisisManagerMenu.7000.7400.A.name
		custom_tooltip = CrisisManagerMenu.7000.7400.A.tooltip
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			any_country = { is_country_type = fallen_empire }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7400 } }
	}
	option = {
		name = CrisisManagerMenu.7000.7400.B.name
		custom_tooltip = CrisisManagerMenu.7000.7400.B.tooltip
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			NOT = { any_country = { is_country_type = fallen_empire } }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}

	### Create/Delete L-Gate
	option = {
		name = CrisisManagerMenu.7000.7500.name
		custom_tooltip = CrisisManagerMenu.7000.7500.tooltip
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			has_distar = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7500 } }
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}
	option = {
		name = CmtTextGoBack.name
		custom_tooltip = CmtTextGoBack.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.0100 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

#########################################
### Trigger End-Game Crisis Manuallly ###
#########################################

### Menu
country_event = {
	id = CrisisManagerMenu.7110
	title = CrisisManagerMenu.7110.name
	desc = CrisisManagerMenu.7110.desc
	picture = GFX_evt_CmtMenuA
	is_triggered_only = yes

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Random/All
	option = {
		name = CrisisManagerMenu.7110a1.name
		custom_tooltip = CrisisManagerMenu.7110a1.tooltip
		trigger = {
			NOR = {
				has_global_flag = galactic_crisis_happened
				event_target:CmtGlobalVar = { check_variable = { which = CmtVarMultiple value = 5 } }
			}
			NAND = {
				CmtTriggerForbiddenPrethoryn = yes
				CmtTriggerForbiddenExds = yes
				CmtTriggerForbiddenContingency = yes
				CmtTriggerForbiddenForcedEoc = yes
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7111 } }
	}
	option = {
		name = CrisisManagerMenu.7110a2.name
		custom_tooltip = CrisisManagerMenu.7110a2.tooltip
		trigger = {
			NOT = { has_global_flag = galactic_crisis_happened }
			NAND = {
				CmtTriggerForbiddenPrethoryn = yes
				CmtTriggerForbiddenExds = yes
				CmtTriggerForbiddenContingency = yes
				CmtTriggerForbiddenForcedEoc = yes
			}
			event_target:CmtGlobalVar = { check_variable = { which = CmtVarMultiple value = 5 } }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7111 } }
	}

	### Prethoryn
	option = {
		name = CrisisManagerMenu.7110b1.name
		custom_tooltip = CrisisManagerMenu.7110b1.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagPrethorynTriggered } }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7112 } }
	}
	option = {
		name = CrisisManagerMenu.7110b2.name
		custom_tooltip = CrisisManagerMenu.7110b2.tooltip
		trigger = { has_global_flag = CmtFlagPrethorynTriggered }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Sentinels
	option = {
		name = CrisisManagerMenu.7110c1.name
		custom_tooltip = CrisisManagerMenu.7110c1.tooltip
		trigger = {
			OR = {
				has_global_flag = CmtFlagDebugMode
				AND = {
					has_global_flag = prethoryn_arrival
					CmtTriggerExistPrethoryn = yes
				}
			}
			NOT = { has_global_flag = sentinels_founded }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7113 } }
	}
	option = {
		name = CrisisManagerMenu.7110c2.name
		custom_tooltip = CrisisManagerMenu.7110c2.tooltip
		trigger = { has_global_flag = sentinels_founded }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Unbidden
	option = {
		name = CrisisManagerMenu.7110d1.name
		custom_tooltip = CrisisManagerMenu.7110d1.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagExdsTriggered } }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7114 } }
	}
	option = {
		name = CrisisManagerMenu.7110d2.name
		custom_tooltip = CrisisManagerMenu.7110d2.tooltip
		trigger = { has_global_flag = CmtFlagExdsTriggered }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Aberrant
	option = {
		name = CrisisManagerMenu.7110e1.name
		custom_tooltip = CrisisManagerMenu.7110e1.tooltip
		trigger = {
			OR = {
				has_global_flag = CmtFlagDebugMode
				AND = {
					has_global_flag = extradimensional_invasion_happened
					CmtTriggerExistExds = yes
				}
			}
			NOT = { has_global_flag = extradimensional_second_portal }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7115 } }
	}
	option = {
		name = CrisisManagerMenu.7110e2.name
		custom_tooltip = CrisisManagerMenu.7110e2.tooltip
		trigger = { has_global_flag = extradimensional_second_portal }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Vehement
	option = {
		name = CrisisManagerMenu.7110f1.name
		custom_tooltip = CrisisManagerMenu.7110f1.tooltip
		trigger = {
			OR = {
				has_global_flag = CmtFlagDebugMode
				AND = {
					has_global_flag = extradimensional_invasion_happened
					has_global_flag = extradimensional_second_portal
					CmtTriggerExistExds = yes
				}
			}
			NOT = { has_global_flag = extradimensional_third_portal }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7116 } }
	}
	option = {
		name = CrisisManagerMenu.7110f2.name
		custom_tooltip = CrisisManagerMenu.7110f2.tooltip
		trigger = { has_global_flag = extradimensional_third_portal }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Contingency
	option = {
		name = CrisisManagerMenu.7110g1.name
		custom_tooltip = CrisisManagerMenu.7110g1.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagContingencyTriggerd } }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7117 } }
	}
	option = {
		name = CrisisManagerMenu.7110g2.name
		custom_tooltip = CrisisManagerMenu.7110g2.tooltip
		trigger = { has_global_flag = CmtFlagContingencyTriggerd }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Cybrex
	option = {
		name = CrisisManagerMenu.7110h1.name
		custom_tooltip = CrisisManagerMenu.7110h1.tooltip
		trigger = {
			OR = {
				has_global_flag = CmtFlagDebugMode
				AND = {
					has_global_flag = ai_invasion_ongoing
					CmtTriggerExistContingency = yes
				}
			}
			NOT = { has_global_flag = cybrex_resurface }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7118 } }
	}
	option = {
		name = CrisisManagerMenu.7110h2.name
		custom_tooltip = CrisisManagerMenu.7110h2.tooltip
		trigger = { has_global_flag = cybrex_resurface }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### End of the Cycle
	option = {
		name = CrisisManagerMenu.7110i1.name
		custom_tooltip = CrisisManagerMenu.7110i1.tooltip
		trigger = { CmtTriggerAllowedManualForcedEoc = yes }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7119 } }
	}
	option = {
		name = CrisisManagerMenu.7110i2.name
		custom_tooltip = CrisisManagerMenu.7110i2.tooltip
		trigger = { has_global_flag = CmtFlagForcedEocTriggered }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.7110i3.name
		custom_tooltip = CrisisManagerMenu.7110i3.tooltip
		trigger = {
			NOR = {
				CmtTriggerAllowedManualForcedEoc = yes
				has_global_flag = CmtFlagForcedEocTriggered
			}
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}

	### Go Back, etc.
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}
	option = {
		name = CmtTextGoBack.name
		custom_tooltip = CmtTextGoBack.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Trigger Random Crisis or All Crises.
country_event = {
	id = CrisisManagerMenu.7111
	title = CrisisManagerMenu.7111.name
	desc = {
		text = CrisisManagerMenu.7111.desc1
		trigger = { NOT = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarMultiple value = 5 } } } }
	}
	desc = {
		text = CrisisManagerMenu.7111.desc2
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarMultiple value = 5 } } }
	}
	picture = GFX_evt_CmtMenuA
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb1.name
		custom_tooltip = CrisisManagerMenu.711xb1.tooltip
		hidden_effect = {
			while = {
				limit = { NOT = { has_global_flag = galactic_crisis_happened } }
				country_event = { id = CrisisManagerControl.0012 }
			}
			country_event = { id = CrisisManagerMenu.7121 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7121
	title = CrisisManagerMenu.7121.name
	desc = {
		text = CrisisManagerMenu.7121.desc1
		trigger = { NOT = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarMultiple value = 5 } } } }
	}
	desc = {
		text = CrisisManagerMenu.7121.desc2
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarMultiple value = 5 } } }
	}
	picture = GFX_evt_CmtMenuA
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Call Prethoryn
country_event = {
	id = CrisisManagerMenu.7112
	title = CrisisManagerMenu.7112.name
	desc = CrisisManagerMenu.7112.desc
	picture = GFX_evt_physics_research
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb1.name
		custom_tooltip = CrisisManagerMenu.711xb1.tooltip
		hidden_effect = {
			country_event = { id = CrisisManagerControl.1000 }
			country_event = { id = CrisisManagerMenu.7122 }
		}
	}
	option = {
		name = CrisisManagerMenu.711xc.name
		custom_tooltip = CrisisManagerMenu.711xc.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { country_event = { id = crisis.199 } }
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7122
	title = CrisisManagerMenu.7122.name
	desc = CrisisManagerMenu.7122.desc
	picture = GFX_evt_physics_research
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Call Sentinels
country_event = {
	id = CrisisManagerMenu.7113
	title = CrisisManagerMenu.7113.name
	desc = CrisisManagerMenu.7113.desc
	picture = GFX_evt_federation_fleet
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb2.name
		custom_tooltip = CrisisManagerMenu.711xb2.tooltip
		hidden_effect = {
			CmtEffectCallSentinel = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Call Unbidden
country_event = {
	id = CrisisManagerMenu.7114
	title = CrisisManagerMenu.7114.name
	desc = CrisisManagerMenu.7114.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb1.name
		custom_tooltip = CrisisManagerMenu.711xb1.tooltip
		hidden_effect = {
			country_event = { id = CrisisManagerControl.2000 }
			country_event = { id = CrisisManagerMenu.7124 }
		}
	}
	option = {
		name = CrisisManagerMenu.711xc.name
		custom_tooltip = CrisisManagerMenu.711xc.tooltip
		hidden_effect = {
			country_event = { id = crisis.1000 }
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7124
	title = CrisisManagerMenu.7124.name
	desc = CrisisManagerMenu.7124.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Call Aberrant
country_event = {
	id = CrisisManagerMenu.7115
	title = CrisisManagerMenu.7115.name
	desc = CrisisManagerMenu.7115.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb2.name
		custom_tooltip = CrisisManagerMenu.711xb2.tooltip
		hidden_effect = {
			CmtEffectCallAberrant = yes
			country_event = { id = CrisisManagerMenu.7125 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7125
	title = CrisisManagerMenu.7125.name
	desc = CrisisManagerMenu.7125.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Call Vehement
country_event = {
	id = CrisisManagerMenu.7116
	title = CrisisManagerMenu.7116.name
	desc = CrisisManagerMenu.7116.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb2.name
		custom_tooltip = CrisisManagerMenu.711xb2.tooltip
		hidden_effect = {
			CmtEffectCallVehement = yes
			country_event = { id = CrisisManagerMenu.7125 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7126
	title = CrisisManagerMenu.7126.name
	desc = CrisisManagerMenu.7126.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Call Contingency
country_event = {
	id = CrisisManagerMenu.7117
	title = CrisisManagerMenu.7117.name
	desc = CrisisManagerMenu.7117.desc
	picture = GFX_evt_glitchy_matrix
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb1.name
		custom_tooltip = CrisisManagerMenu.711xb1.tooltip
		hidden_effect = {
			country_event = { id = CrisisManagerControl.3000 }
			country_event = { id = CrisisManagerMenu.7127 }
		}
	}
	option = {
		name = CrisisManagerMenu.711xc.name
		custom_tooltip = CrisisManagerMenu.711xc.tooltip
		hidden_effect = {
			country_event = { id = crisis.2000 }
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7127
	title = CrisisManagerMenu.7127.name
	desc = CrisisManagerMenu.7127.desc
	picture = GFX_evt_glitchy_matrix
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Call Cybrex
country_event = {
	id = CrisisManagerMenu.7118
	title = CrisisManagerMenu.7118.name
	desc = CrisisManagerMenu.7118.desc
	picture = GFX_evt_ringworld
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb2.name
		custom_tooltip = CrisisManagerMenu.711xb2.tooltip
		hidden_effect = {
			CmtEffectCallCybrex = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Force Covenant of End of the Cycle.
country_event = {
	id = CrisisManagerMenu.7119
	title = CrisisManagerMenu.7119.name
	desc = CrisisManagerMenu.7119.desc
	picture = GFX_evt_unspeakable_horror
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7110 } }
	}
	option = {
		name = CrisisManagerMenu.711xb1.name
		custom_tooltip = CrisisManagerMenu.711xb1.tooltip
		hidden_effect = {
			country_event = { id = CrisisManagerControl.4000 }
			country_event = { id = CrisisManagerMenu.7129 }
		}
	}
	option = {
		name = CrisisManagerMenu.711xc.name
		custom_tooltip = CrisisManagerMenu.711xc.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarTermForcedEoc value = -1 } }
			CmtEffectTargetingForcedEoc = yes
			event_target:CmtTargetVictimForcedEoc = {
				country_event = { id = CrisisManagerControl.4101 }
				country_event = { id = CrisisManagerControl.4102 }
			}
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

country_event = {
	id = CrisisManagerMenu.7129
	title = CrisisManagerMenu.7129.name
	desc = CrisisManagerMenu.7129.desc
	picture = GFX_evt_unspeakable_horror
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Sleeper Awakening
country_event = {
	id = CrisisManagerMenu.7135
	title = CrisisManagerMenu.7135.name
	desc = CrisisManagerMenu.7135.desc
	picture = GFX_evt_fallen_empire_awakes
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }
	after = {
		hidden_effect = {
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
	}
	option = {
		name = CrisisManagerMenu.7135b.name
		custom_tooltip = CrisisManagerMenu.7135b.tooltip
		allow = {
			any_country = { CmtTriggerIsOrganicSleeper = yes }
		}
		trigger = { ## 1 or more
			any_country = { is_country_type = fallen_empire }
			# count_country = { limit = { is_country_type = fallen_empire } count > 0 } # CmtTriggerIsOrganicSleeper = yes
		}
		hidden_effect = {
			if = {
				limit = {
					any_country = {
						CmtTriggerIsAwakenableSleeper = yes
						CmtTriggerCheckSleeperFleetPower = yes
					}
				}
				random_country = {
					limit = {
						CmtTriggerIsAwakenableSleeper = yes
						CmtTriggerCheckSleeperFleetPower = yes
					}
					country_event = { id = fallen_empires_awakening.1 }
				}
			} else = {
				random_country = {
					limit = { CmtTriggerIsOrganicSleeper = yes }
					country_event = { id = fallen_empires_awakening.1 }
				}
			}
		}
	}

	option = {
		name = CrisisManagerMenu.7135c1.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper1 = { CmtTriggerIsOrganicSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper1
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper1 = { country_event = { id = fallen_empires_awakening.1 } }
		}
	}
	option = {
		name = CrisisManagerMenu.7135c2.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper2 = { CmtTriggerIsOrganicSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper2
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper2 = { country_event = { id = fallen_empires_awakening.1 } }
		}
	}
	option = {
		name = CrisisManagerMenu.7135c3.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper3 = { CmtTriggerIsOrganicSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper3
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper3 = { country_event = { id = fallen_empires_awakening.1 } }
		}
	}
	option = {
		name = CrisisManagerMenu.7135c4.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper4 = { CmtTriggerIsOrganicSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper4
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper4 = { country_event = { id = fallen_empires_awakening.1 } }
		}
	}
	option = { # Custodian
		name = CrisisManagerMenu.7135c5.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		trigger = {
			exists = event_target:CmtTargetManualSleeper5
			hidden_trigger = {
				event_target:CmtTargetManualSleeper5 = { CmtTriggerIsOrganicSleeper = no is_country_type = fallen_empire }
			}
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper5 = {
				# random_list = {
				# 	66 = { set_country_flag = fallen_machine_empire_awaken_1 }	# Custodian
				# 	33 = { set_country_flag = fallen_machine_empire_awaken_2 }	# Berserker
				# }
				set_country_flag = fallen_machine_empire_awaken_1
				country_event = { id = fallen_machine_empire.1 }
			}
		}
	}
	option = { # Berserker
		name = CrisisManagerMenu.7135c6.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		trigger = {
			exists = event_target:CmtTargetManualSleeper5
			hidden_trigger = {
				event_target:CmtTargetManualSleeper5 = { CmtTriggerIsOrganicSleeper = no is_country_type = fallen_empire }
			}
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper5 = {
				set_country_flag = fallen_machine_empire_awaken_2
				country_event = { id = fallen_machine_empire.1 }
			}
		}
	}
	option = { # Create New FE
		name = CrisisManagerMenu.7135c7.name # CREATE_NEW_EMPIRE
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		trigger = {
			OR = {
				NOR = {
					exists = event_target:CmtTargetManualSleeper1
					exists = event_target:CmtTargetManualSleeper2
					exists = event_target:CmtTargetManualSleeper3
					exists = event_target:CmtTargetManualSleeper4
					# exists = event_target:CmtTargetManualSleeper5
				}
				has_global_flag = war_in_heaven_debug
			}
		}
		hidden_effect = {
			country_event = { id = extra_sleeper_deus.1 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### War in Heaven
country_event = {
	id = CrisisManagerMenu.7136
	title = CrisisManagerMenu.7136.name
	desc = {
		text = CrisisManagerMenu.7136.desc1
		trigger = { NOT = { exists = event_target:CmtTargetManualSleeperA } }
	}
	desc = {
		text = CrisisManagerMenu.7136.desc2
		trigger = {
			exists = event_target:CmtTargetManualSleeperA
			NOT = { exists = event_target:CmtTargetManualSleeperB }
		}
	}
	desc = {
		text = CrisisManagerMenu.7136.desc3
		trigger = {
			exists = event_target:CmtTargetManualSleeperA
			exists = event_target:CmtTargetManualSleeperB
		}
	}
	picture = GFX_evt_fallen_empire_awakes
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }

	option = { # back
		name = CrisisManagerMenu.7136a.name
		custom_tooltip = CrisisManagerMenu.7136a.tooltip
		hidden_effect = {
			if = {
				limit = { exists = event_target:CmtTargetManualSleeperA }
				clear_global_event_target = CmtTargetManualSleeperA
			}
			if = {
				limit = { exists = event_target:CmtTargetManualSleeperB }
				clear_global_event_target = CmtTargetManualSleeperB
			}
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	option = { # random
		name = CrisisManagerMenu.7136b.name
		custom_tooltip = CrisisManagerMenu.7136b.tooltip
		trigger = {
			NAND = {
				exists = event_target:CmtTargetManualSleeperA
				exists = event_target:CmtTargetManualSleeperB
			}
		}
		hidden_effect = {
			if = {
				limit = { exists = event_target:CmtTargetManualSleeperA }
				random_country = {
					limit = {
						# CmtTriggerIsAwakenableSleeper = yes
						is_fallen_empire = yes
						is_at_war = no
						NOT = { is_same_empire = event_target:CmtTargetManualSleeperA }
					}
					weights = {
						base = 1
						modifier = { add = 2 CmtTriggerIsOrganicSleeper = yes }
						modifier = { add = 5 CmtTriggerIsAwakenableSleeper = yes }
					}
					save_global_event_target_as = CmtTargetManualSleeperB
				}
			} else = {
				random_country = {
					limit = { CmtTriggerIsOrganicSleeper = yes } # CmtTriggerIsAwakenableSleeper = yes
					weights = {
						base = 1
						modifier = { add = 5 CmtTriggerCheckSleeperFleetPower = no }
					}
					save_global_event_target_as = CmtTargetManualSleeperA
				}
			}
			if = { # Automatically last possible option
				limit = {
					NOT = { exists = event_target:CmtTargetManualSleeperB }
					count_country = {
						count < 2
						limit = {
							CmtTriggerIsAwakenableSleeper = yes
							NOT = { is_same_empire = event_target:CmtTargetManualSleeperA }
						}
					}
				}
				random_country = {
					limit = {
						# CmtTriggerIsAwakenableSleeper = yes
						is_fallen_empire = yes
						is_at_war = no
						NOT = { is_same_empire = event_target:CmtTargetManualSleeperA }
					}
					weights = {
						base = 1
						modifier = { add = 2 CmtTriggerIsOrganicSleeper = yes }
						modifier = { add = 5 CmtTriggerIsAwakenableSleeper = yes }
					}
					save_global_event_target_as = CmtTargetManualSleeperB
				}
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}

	option = { # 1
		name = CrisisManagerMenu.7136c1.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper1 = { CmtTriggerIsAwakenableSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper1
			NAND = {
				exists = event_target:CmtTargetManualSleeperA
				exists = event_target:CmtTargetManualSleeperB
			}
			event_target:CmtTargetManualSleeper1 = {
				# CmtTriggerIsOrganicSleeper = yes
				NAND = {
					exists = event_target:CmtTargetManualSleeperA
					is_same_empire = event_target:CmtTargetManualSleeperA
				}
			}
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper1 = {
				if = {
					limit = { exists = event_target:CmtTargetManualSleeperA }
					save_global_event_target_as = CmtTargetManualSleeperB
				} else = { save_global_event_target_as = CmtTargetManualSleeperA }
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}
	option = { # 2
		name = CrisisManagerMenu.7136c2.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper2 = { CmtTriggerIsAwakenableSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper2
			NAND = {
				exists = event_target:CmtTargetManualSleeperA
				exists = event_target:CmtTargetManualSleeperB
			}
			event_target:CmtTargetManualSleeper2 = {
				# CmtTriggerIsOrganicSleeper = yes
				NAND = {
					exists = event_target:CmtTargetManualSleeperA
					is_same_empire = event_target:CmtTargetManualSleeperA
				}
			}
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper2 = {
				if = {
					limit = { exists = event_target:CmtTargetManualSleeperA }
					save_global_event_target_as = CmtTargetManualSleeperB
				} else = { save_global_event_target_as = CmtTargetManualSleeperA }
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}
	option = { # 3
		name = CrisisManagerMenu.7136c3.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = {
			event_target:CmtTargetManualSleeper3 = { CmtTriggerIsAwakenableSleeper = yes }
		}
		trigger = {
			exists = event_target:CmtTargetManualSleeper3
			NAND = {
				exists = event_target:CmtTargetManualSleeperA
				exists = event_target:CmtTargetManualSleeperB
			}
			event_target:CmtTargetManualSleeper3 = {
				# CmtTriggerIsOrganicSleeper = yes
				NAND = {
					exists = event_target:CmtTargetManualSleeperA
					is_same_empire = event_target:CmtTargetManualSleeperA
				}
			}
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper3 = {
				if = {
					limit = { exists = event_target:CmtTargetManualSleeperA }
					save_global_event_target_as = CmtTargetManualSleeperB
				} else = { save_global_event_target_as = CmtTargetManualSleeperA }
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}
	option = { # 4
		name = CrisisManagerMenu.7136c4.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		trigger = {
			exists = event_target:CmtTargetManualSleeper4
			NAND = {
				exists = event_target:CmtTargetManualSleeperA
				exists = event_target:CmtTargetManualSleeperB
			}
			event_target:CmtTargetManualSleeper4 = {
				# CmtTriggerIsOrganicSleeper = yes
				NAND = {
					exists = event_target:CmtTargetManualSleeperA
					is_same_empire = event_target:CmtTargetManualSleeperA
				}
			}
		}
		allow = {
			event_target:CmtTargetManualSleeper4 = { CmtTriggerIsAwakenableSleeper = yes }
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper4 = {
				if = {
					limit = { exists = event_target:CmtTargetManualSleeperA }
					save_global_event_target_as = CmtTargetManualSleeperB
				} else = { save_global_event_target_as = CmtTargetManualSleeperA }
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}

	option = { # 5 Machine / Custodian / Berserker only as 2nd option
		name = CrisisManagerMenu.7136c5.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		trigger = {
			exists = event_target:CmtTargetManualSleeper5
			exists = event_target:CmtTargetManualSleeperA
			NOT = { exists = event_target:CmtTargetManualSleeperB }
			event_target:CmtTargetManualSleeper5 = {
				NAND = {
					exists = event_target:CmtTargetManualSleeperA
					is_same_empire = event_target:CmtTargetManualSleeperA
				}
			}
			hidden_trigger = {
				event_target:CmtTargetManualSleeper5 = { is_at_war = no CmtTriggerIsOrganicSleeper = no }
			}
		}
		hidden_effect = {
			event_target:CmtTargetManualSleeper5 = {
				if = {
					limit = { exists = event_target:CmtTargetManualSleeperA }
					save_global_event_target_as = CmtTargetManualSleeperB
				} else = { save_global_event_target_as = CmtTargetManualSleeperA }
			}
			country_event = { id = CrisisManagerMenu.7136 }
		}
	}

	option = { # Final
		name = CrisisManagerMenu.7136d.name
		custom_tooltip = CrisisManagerMenu.7136d.tooltip
		allow = {
			hidden_trigger = {
				event_target:CmtTargetManualSleeperB = { CmtTriggerCandidateAncientRival = yes }
				OR = {
					NOT = { has_country_flag = war_in_heaven_timer }	## Moratorium Term
					has_global_flag = war_in_heaven_debug
					event_target:CmtGlobalVar = { check_variable = { which = CmtVarHeavenPreludeSpeed value = 4 } }
				}
			}
			# custom_tooltip = {
			# 	fail_text =
			# }
		}
		trigger = { hidden_trigger = {
			exists = event_target:CmtTargetManualSleeperA
			exists = event_target:CmtTargetManualSleeperB
		} }
		hidden_effect = {
			event_target:CmtTargetManualSleeperA = {
				save_global_event_target_as = CmtTargetFirstSleeper
				country_event = { id = fallen_empires_awakening.1 }
			}
			event_target:CmtTargetManualSleeperB = {
				if = {
					limit = {
						exists = event_target:CmtTargetManualSleeper5
						is_same_empire = event_target:CmtTargetManualSleeper5
					}
					set_country_flag = fallen_machine_empire_awaken_2	# Berserker
					country_event = { id = fallen_machine_empire.1 }
				}
				CmtEffectSetAnciantRival = yes
			}
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7000 }
			# CmtTargetManualSleeperA CmtTargetManualSleeperB are needed later for MTTH check (so don't clear here)
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Khan
country_event = {
	id = CrisisManagerMenu.7138
	title = CrisisManagerMenu.7138.name
	desc = CrisisManagerMenu.7138.desc
	picture = GFX_evt_khan_throne_room
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { NOT = { exists = event_target:marauder_country_1 } }
			random_country = {
				limit = { has_country_flag = marauder_1 CmtTriggerHasPotentialKhanAwaking = yes }
				save_global_event_target_as = marauder_country_1
			}
		}
		if = {
			limit = { NOT = { exists = event_target:marauder_country_2 } }
			random_country = {
				limit = { has_country_flag = marauder_2 CmtTriggerHasPotentialKhanAwaking = yes }
				save_global_event_target_as = marauder_country_2
			}
		}
		if = {
			limit = { NOT = { exists = event_target:marauder_country_3 } }
			random_country = {
				limit = { has_country_flag = marauder_3 CmtTriggerHasPotentialKhanAwaking = yes }
				save_global_event_target_as = marauder_country_3
			}
		}

		if = { # Very strong fallback
			limit = {
				NOR = {
					exists = event_target:marauder_country_1
					exists = event_target:marauder_country_2
					exists = event_target:marauder_country_3
					# any_country = { is_country_type = dormant_marauders }
				}
			}
			random_country = {
				limit = {
					has_origin = "origin_khan_successor"
					NOT = { has_country_flag = democratic_khanate_flag }
					OR = {
						has_country_flag = new_khanate_flag
						has_country_flag = diadochi
					}
					any_system_within_border = {
						has_star_flag = marauder_system
						OR = {
							CmtTriggerMarauderCapitalSystem = yes
							any_neighbor_system = {
								has_owner = no
								CmtTriggerMarauderCapitalSystem = yes
							}
						}
					}
				}
				random_system_within_border = {
					limit = {
						has_star_flag = marauder_system
						OR = {
							CmtTriggerMarauderCapitalSystem = yes
							any_neighbor_system = { has_owner = no CmtTriggerMarauderCapitalSystem = yes }
						}
					}
					if = {
						limit = { CmtTriggerMarauderCapitalSystem = no }
						random_neighbor_system = {
							limit = { has_owner = no CmtTriggerMarauderCapitalSystem = yes }
							save_event_target_as = former_marauder_capital
						}
					} else = { save_event_target_as = former_marauder_capital }
				}
				if = { limit = { NOT = { exists = event_target:former_marauder_capital } }
					capital_scope.solar_system = {
						save_event_target_as = former_marauder_capital
					}
				}
				event_target:former_marauder_capital = {
					switch = {
						trigger = has_star_flag
						marauder_capital_1 = {
							prev = { set_country_flag = marauder_1 save_global_event_target_as = marauder_country_1 }
						}
						marauder_capital_2 = {
							prev = { set_country_flag = marauder_2 save_global_event_target_as = marauder_country_2 }
						}
						default = { # marauder_capital_3
							prev = { set_country_flag = marauder_3 save_global_event_target_as = marauder_country_3 }
						}
					}
				}
				# log="Manual marauder fallback 1 \\[former_marauder_capital.GetName]"
			}
			# Create very strong fallback (look for dead marauders)
			if = {
				limit = {
					NOT = { exists = event_target:former_marauder_capital }
					any_system = { has_owner = no has_star_flag = marauder_system }
				}
				# log="Manual marauder fallback 2"
				random_system = {
					limit = { has_owner = no has_star_flag = marauder_system }
					weights = {
						base = 1
						modifier = {
							add = 3
							CmtTriggerMarauderCapitalSystem = yes
						}
						modifier = {
							add = 2
							any_neighbor_system = {
								has_owner = no
								has_star_flag = marauder_system
							}
						}
						modifier = {
							add = 1
							any_neighbor_system = { has_owner = no }
						}
						modifier = {
							add = 3
							any_system_planet = { has_owner = no has_planet_flag = marauder_rally_point }
						}
					}
					random_system_planet = {
						limit = { is_a_planet = yes }
						weights = {
							base = 1
							modifier = {
								add = 3
								has_planet_flag = marauder_rally_point
							}
						}
						save_event_target_as = former_marauder_capital
						# log="Manual marauder strong fallback \\[This.GetName]"
					}
				}
			} else = { no_scope = { save_event_target_as = former_marauder_capital } } # clear
		}
	}

	after = {

		if = {
			limit = { exists = event_target:marauder_country_1 NOT = { event_target:marauder_country_1 = { CmtTriggerHasPotentialKhanAwaking = yes } } }
			clear_global_event_target = marauder_country_1
		}
		if = {
			limit = { exists = event_target:marauder_country_2 NOT = { event_target:marauder_country_2 = { CmtTriggerHasPotentialKhanAwaking = yes } } }
			clear_global_event_target = marauder_country_2
		}
		if = {
			limit = { exists = event_target:marauder_country_3 NOT = { event_target:marauder_country_3 = { CmtTriggerHasPotentialKhanAwaking = yes } } }
			clear_global_event_target = marauder_country_3
		}

		# legacy
		# if = {
		# 	limit = { exists = event_target:CmtTargetManualMarauder1 }
		# 	clear_global_event_target = CmtTargetManualMarauder1
		# }
		# if = {
		# 	limit = { exists = event_target:CmtTargetManualMarauder2 }
		# 	clear_global_event_target = CmtTargetManualMarauder2
		# }
		# if = {
		# 	limit = { exists = event_target:CmtTargetManualMarauder3 }
		# 	clear_global_event_target = CmtTargetManualMarauder3
		# }

		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}

	option = {
		name = CrisisManagerMenu.71xxa.name
		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
	}
	option = {
		name = CrisisManagerMenu.7138b.name
		custom_tooltip = CrisisManagerMenu.7138b.tooltip
		trigger = {
			NAND = {
				exists = event_target:former_marauder_capital
				event_target:former_marauder_capital = { is_scope_type = planet }
			}
		}
		hidden_effect = {
			random_country = {
				limit = { CmtTriggerHasPotentialKhanAwaking = yes }
				CmtEffectTriggerMarauderManually = yes
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7138c1.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = { event_target:marauder_country_1 = { CmtTriggerHasPotentialKhanAwaking = yes }	}
		trigger = {
			exists = event_target:marauder_country_1
		}
		hidden_effect = {
			event_target:marauder_country_1 = { CmtEffectTriggerMarauderManually = yes }
		}
	}
	option = {
		name = CrisisManagerMenu.7138c2.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = { event_target:marauder_country_2 = { CmtTriggerHasPotentialKhanAwaking = yes }	}
		trigger = {
			exists = event_target:marauder_country_2
		}
		hidden_effect = {
			event_target:marauder_country_2 = { CmtEffectTriggerMarauderManually = yes }
		}
	}
	option = {
		name = CrisisManagerMenu.7138c3.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		allow = { event_target:marauder_country_3 = { CmtTriggerHasPotentialKhanAwaking = yes }	}
		trigger = {
			exists = event_target:marauder_country_3
		}
		hidden_effect = {
			event_target:marauder_country_3 = { CmtEffectTriggerMarauderManually = yes }
		}
	}
	option = { # Restore
		name = CrisisManagerMenu.7138b.name
		custom_tooltip = CrisisManagerMenu.7135c.tooltip
		trigger = {
			exists = event_target:former_marauder_capital
			event_target:former_marauder_capital = { is_scope_type = planet }
		}
		hidden_effect = {
			event_target:former_marauder_capital = {
				create_species = {
					name = random
					class = random
					blocked_archetypes = { MACHINE ROBOT LITHOID }
					portrait = random
					traits = {
						trait = "trait_pc_habitat_preference"
						trait = "trait_extremely_adaptive"
						trait = "trait_rapid_breeders"
						trait = "trait_nomadic"
						trait = "trait_quarrelsome"
						trait = "trait_deviants"
					}
				}
				create_country = {
					name_list = random
					species = last_created_species
					type = dormant_marauders
					civics = { civic = civic_anarcho_tribalism civic = civic_warrior_culture civic = civic_barbaric_despoilers }
					origin = "origin_khan_successor"
					flag = {
						icon = { category = "pirate" file = "flag_pirate_13.dds" }
						background= { category = "backgrounds" file = "00_solid.dds" }
						colors={ "black" "black" "null" "null" }
					}
					ethos = {
						ethic = ethic_fanatic_spiritualist
						ethic = ethic_xenophobe
					}
					ignore_initial_colony_error = yes
					effect = {
						set_graphical_culture = pirate_01
						set_country_flag = restored_marauders_flag
						set_name = random
						create_ship_design = { design = "NAME_Marauder_Starbase" }
						add_ship_design = last_created_design
						save_event_target_as = marauder_starbase_owner
						set_custom_capital_location = prev
					}
				}
			}
			last_created_country = {
				prev.solar_system = {
					switch = {
						trigger = has_star_flag
						marauder_capital_1 = {
							prev = { set_country_flag = marauder_1 save_global_event_target_as = marauder_country_1 }
						}
						marauder_capital_2 = {
							prev = { set_country_flag = marauder_2 save_global_event_target_as = marauder_country_2 }
						}
						default = { # marauder_capital_3
							prev = { set_country_flag = marauder_3 save_global_event_target_as = marauder_country_3 }
						}
					}
					create_marauder_starbase = yes
				}
				CmtEffectCreateFleet_KhanSubReinforcement3 = yes
				random_neighbor_system = {
					limit = { has_owner = no }
					weights = {
						base = 1
						modifier = { add = 2 has_star_flag = marauder_system }
					}
					create_marauder_starbase = yes
					prev = { CmtEffectCreateFleet_KhanSubReinforcement3 = yes }
				}
				CmtEffectTriggerMarauderManually = yes
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Open L-Gate and Trigger L-Cluster Event
country_event = {
	id = CrisisManagerMenu.7140
	title = CrisisManagerMenu.7140.name
	desc = CrisisManagerMenu.7140.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	option = {
		name = CrisisManagerMenu.7140b.name
		custom_tooltip = CrisisManagerMenu.7140b.tooltip
		trigger = { NOT = { has_global_flag = l_cluster_opened } }
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualTemp value = 0 } }		## Random
			country_event = { id = CrisisManagerMenu.7141 }
		}
	}
	option = {
		name = CrisisManagerMenu.7140c1.name
		custom_tooltip = CrisisManagerMenu.7140c.tooltip
		trigger = { NOT = { has_global_flag = l_cluster_opened } }
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualTemp value = 1 } }		## Eerie Silence
			country_event = { id = CrisisManagerMenu.7141 }
		}
	}
	option = {
		name = CrisisManagerMenu.7140c2.name
		custom_tooltip = CrisisManagerMenu.7140c.tooltip
		trigger = { NAND = { has_global_flag = l_cluster_opened has_global_flag = dragon_season } }
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualTemp value = 2 } }		## L-Drake
			country_event = { id = CrisisManagerMenu.7141 }
		}
	}
	option = {
		name = CrisisManagerMenu.7140c3.name
		custom_tooltip = CrisisManagerMenu.7140c.tooltip
		trigger = {
			NAND = {
				has_global_flag = l_cluster_opened
				has_global_flag = gray_goo_empire_set
				exists = event_target:graygoo_country # gate_builders
			}
		}
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualTemp value = 3 } }		## Dessanu
			country_event = { id = CrisisManagerMenu.7141 }
		}
	}

	option = {
		name = CrisisManagerMenu.7140c4.name
		custom_tooltip = CrisisManagerMenu.7140c.tooltip
		trigger = {
			NAND = {
				has_global_flag = l_cluster_opened
				has_global_flag = gray_goo_crisis_active
			}
		}
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualTemp value = 4 } }		## Gray Tempest
			country_event = { id = CrisisManagerMenu.7141 }
		}
	}

	### Go Back, etc.
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}
	option = {
		name = CmtTextGoBack.name
		custom_tooltip = CmtTextGoBack.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Open L-Gate and Trigger L-Cluster Event: Select Target L-Gate
country_event = {
	id = CrisisManagerMenu.7141
	title = CrisisManagerMenu.7141.name
	desc = {
		text = CrisisManagerMenu.7141.desc1
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value <= 8 } } }
	}
	desc = {
		text = CrisisManagerMenu.7141.desc2
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } } }
	}
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	trigger = {
		NOT = { has_global_flag = CmtFlagLgateOpenedNow }
	}

	immediate = {
		CmtEffectManualTargetLgates = yes
	}

	after = {
		hidden_effect = {
			if = {
				limit = {
					exists = event_target:CmtTargetLgateOriginatingSystem
					NOT = { has_global_flag = CmtFlagLgateOpenedNow }
				}
				set_global_flag = CmtFlagLgatePreludeTriggered
				event_target:CmtGlobalVar = {
					if = {
						limit = { check_variable = { which = CmtVarManualTemp value > 0.5 } }
						set_global_flag = CmtFlagLgateForbidSilence
						set_global_flag = CmtFlagLgateForbidLdrake
						set_global_flag = CmtFlagLgateForbidDessanu
						set_global_flag = CmtFlagLgateForbidGraygoo
					}
					if = {
						limit = { check_variable = { which = CmtVarManualTemp value = 1 } }
						remove_global_flag = gray_goo_empire_set
						remove_global_flag = gray_goo_crisis_set
						remove_global_flag = dragon_season
						remove_global_flag = CmtFlagLgateForbidSilence
					} else_if = {
						limit = { check_variable = { which = CmtVarManualTemp value = 2 } }
						remove_global_flag = dragon_season
						remove_global_flag = CmtFlagLgateForbidLdrake
					} else_if = {
						limit = { check_variable = { which = CmtVarManualTemp value = 3 } }
						remove_global_flag = CmtFlagLgateForbidDessanu
					} else_if = {
						limit = { check_variable = { which = CmtVarManualTemp value = 4 } }
						remove_global_flag = CmtFlagLgateForbidGraygoo
					}
				}
				event_target:CmtTargetLgateOriginatingSystem = {
					if = {
						limit = {
							exists = owner
							owner = { CmtTriggerIsPlayableEmpire = yes }
						}
						owner = { save_event_target_as = CmtTempOwner }
					} else_if = {
						limit = {
							has_global_flag = l_cluster_opened
							any_playable_country = { has_country_flag = lcluster_opener }
						}
						random_playable_country = {
							limit = { has_country_flag = lcluster_opener }
							save_event_target_as = CmtTempOwner
						}
					} else = { event_target:CmtGlobalVar = { save_event_target_as = CmtTempOwner } }

					if = {
						limit = {
							has_global_flag = l_cluster_opened
							event_target:CmtGlobalVar = { is_variable_set = CmtVarManualTemp }
						}
						log="Run manual L-Cluster event with: \\[CmtGlobalVar.CmtVarManualTemp] \\[CmtTempOwner.GetName]"
						if = {
							limit = {
								event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualTemp value = 2 } }
								NOT = { has_global_flag = dragon_season }
							}
							set_global_flag = dragon_season
							event_target:CmtTempOwner = { country_event = { id = distar.13000 } }
						} else_if = {
							limit = {
								event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualTemp value = 3 } }
								NAND = {
									has_global_flag = gray_goo_empire_set
									exists = event_target:graygoo_country # gate_builders
								}
							}
							set_global_flag = gray_goo_empire_set
							event_target:CmtTempOwner = { country_event = { id = graygoo.100 } }
						} else_if = {
							limit = {
								event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualTemp value = 4 } }
								NAND = {
									has_global_flag = gray_goo_crisis_active
									exists = event_target:graygoo_country
								}
							}
							set_global_flag = gray_goo_crisis_set
							event_target:CmtTempOwner = { country_event = { id = graygoo.1 } }
						}
						set_timed_global_flag = { flag = CmtFlagLgateOpenedNow days = 5 }
					} else = {
						event_target:CmtTempOwner = { country_event = { id = distar.10950 } }
					}
				}
				country_event = { id = CrisisManagerMenu.7000 }
			}
			CmtEffectClearTargetLgates = yes
			event_target:CmtGlobalVar = {
				clear_variable = CmtVarManualTemp # set_variable = { which = CmtVarManualTemp value = 0 }
			}
		}
	}

	option = {
		name = CrisisManagerMenu.7141a.name		# Back
		custom_tooltip = CrisisManagerMenu.7141a.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = {
				clear_variable = CmtVarManualTemp # set_variable = { which = CmtVarManualTemp value = 0 }
			}
			country_event = { id = CrisisManagerMenu.7140 }
		}
	}
	option = {
		name = CrisisManagerMenu.7141d.name		# Reload
		custom_tooltip = CrisisManagerMenu.7141d.tooltip
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } } }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7141 } }
	}
	option = {
		name = CmtTextSeparator.name			# ----
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			NOT = { has_global_flag = CmtFlagNoSeparator }
			event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } }
		}
		allow = { hidden_trigger = { always = no } }
	}

	option = {
		name = CrisisManagerMenu.7141b.name		# Random
		custom_tooltip = CrisisManagerMenu.7141b.tooltip
		hidden_effect = {
			random_megastructure = {
				limit = { CmtTriggerIsClosedLgate = yes }
				solar_system = { save_global_event_target_as = CmtTargetLgateOriginatingSystem }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7141c1.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem1 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem1 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c2.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem2 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem2 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c3.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem3 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem3 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c4.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem4 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem4 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c5.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem5 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem5 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c6.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem6 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem6 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c7.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem7 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem7 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	option = {
		name = CrisisManagerMenu.7141c8.name
		custom_tooltip = CrisisManagerMenu.7141c.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem8 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem8 = { save_global_event_target_as = CmtTargetLgateOriginatingSystem } }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Open L-Gate after L-Cluster Event Triggered
country_event = {
	id = CrisisManagerMenu.7142
	title = CrisisManagerMenu.7142.name
	desc = CrisisManagerMenu.7142.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes
	trigger = {
		has_global_flag = CmtFlagMidGameEdition
		has_global_flag = l_cluster_opened
	}
	option = {
		name = CrisisManagerMenu.7142a.name
		custom_tooltip = CrisisManagerMenu.7142a.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CrisisManagerMenu.7142b.name
		custom_tooltip = CrisisManagerMenu.7142b.tooltip
		trigger = {
			any_megastructure = { CmtTriggerIsClosedLgate = yes }
		}
		hidden_effect = {
			every_megastructure = {
				limit = { CmtTriggerIsClosedLgate = yes }
				CmtEffectOpenLgate = yes
			}
			country_event = { id = CrisisManagerMenu.7143 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### All L-Gate Opened
country_event = {
	id = CrisisManagerMenu.7143
	title = CrisisManagerMenu.7143.name
	desc = CrisisManagerMenu.7143.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

#### Uprising
# country_event = {
#	id = CrisisManagerMenu.7146
#	title = CrisisManagerMenu.7146.name
#	desc = CrisisManagerMenu.7146.desc
#	picture = GFX_evt_organic_oppression
#	is_triggered_only = yes
#
#	immediate = {
#		CmtEffectManualTargetUprising = yes
#		if = {
#			limit = { exists = event_target:CmtTargetManualUprisingSelected }
#			clear_global_event_target = CmtTargetManualUprisingSelected
#		}
#	}
#
#	after = {
#		hidden_effect = { CmtEffectClearTargetUprising = yes }
#	}
#
#	option = {
#		name = CrisisManagerMenu.71xxa.name
#		custom_tooltip = CrisisManagerMenu.71xxa.tooltip
#		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
#	}
#	option = {
#		name = CrisisManagerMenu.7146b.name
#		custom_tooltip = CrisisManagerMenu.7146b.tooltip
#		trigger = { count_country = { limit = { has_country_flag = CmtFlagManualUprisingListed } count > 1 } }		## 2 or more
#		hidden_effect = {
#			if = {
#				limit = { any_country = { CmtTriggerUprisingMachinePotentialCountry = yes } }
#				random_country = {
#					limit = { CmtTriggerUprisingMachinePotentialCountry = yes }
#					save_global_event_target_as = CmtTargetManualUprisingSelected
#					CmtEffectTriggerUprisingWarCommon = yes
#				}
#			} else = {
#				random_country = {
#					limit = { CmtTriggerUprisingPotentialManually = yes }
#					save_global_event_target_as = CmtTargetManualUprisingSelected
#					CmtEffectTriggerUprisingWarCommon = yes
#				}
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#
#	option = {
#		name = CrisisManagerMenu.7146c1.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising1 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising1 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c2.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising2 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising2 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c3.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising3 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising3 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c4.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising4 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising4 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c5.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising5 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising5 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c6.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising6 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising6 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c7.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising7 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising7 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#	option = {
#		name = CrisisManagerMenu.7146c8.name
#		custom_tooltip = CrisisManagerMenu.7146c.tooltip
#		trigger = { exists = event_target:CmtTargetManualUprising8 }
#		hidden_effect = {
#			event_target:CmtTargetManualUprising8 = {
#				save_global_event_target_as = CmtTargetManualUprisingSelected
#				CmtEffectTriggerUprisingWarCommon = yes
#			}
#			country_event = { id = CrisisManagerMenu.7147 }
#		}
#	}
#}
#
# country_event = {
#	id = CrisisManagerMenu.7147
#	title = CrisisManagerMenu.7147.name
#	desc = CrisisManagerMenu.7147.desc
#	picture = GFX_evt_organic_oppression
#	is_triggered_only = yes
#
#	after = {
#		hidden_effect = { clear_global_event_target = CmtTargetManualUprisingSelected }
#	}
#
#	option = {
#		name = CmtTextOK.name
#		custom_tooltip = CmtTextOK.tooltip
#		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
#	}
#	option = {
#		name = CmtTextExit.name
#		custom_tooltip = CmtTextExit.tooltip
#		hidden_effect = { CmtEffectExitMenu = yes }
#	}
#}

### Player Crisis
country_event = {
	id = CrisisManagerMenu.7150
	title = CrisisManagerMenu.7150.name
	desc = {
		text = CrisisManagerMenu.7150.desc1
		trigger = {
			NOR = {
				has_country_flag = CmtFlagSpMenu
				any_country = { is_at_war = yes }
			}
		}
	}
	desc = {
		text = CrisisManagerMenu.7150.desc2
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			any_country = { is_at_war = yes }
		}
	}
	desc = {
		text = CrisisManagerMenu.7150.desc3
		trigger = { has_country_flag = CmtFlagSpMenu }
	}
	picture = GFX_evt_city_ruins
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { NOT = { has_country_flag = CmtFlagSpMenu } }
			CmtEffectManualTargetPlayerCrisis = yes
		}
	}

	### More Infomation
	option = {
		name = CrisisManagerMenu.7150d.name
		custom_tooltip = CrisisManagerMenu.7150d.tooltip
		trigger = { NOT = { has_country_flag = CmtFlagSpMenu } }
		hidden_effect = {
			set_country_flag = CmtFlagSpMenu
			country_event = { id = CrisisManagerMenu.7150 }
		}
	}
	option = {
		name = CmtTextOK.name
		custom_tooltip = CmtTextOK.tooltip
		trigger = { has_country_flag = CmtFlagSpMenu }
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.7150 }
			remove_country_flag = CmtFlagSpMenu
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_country_flag = CmtFlagSpMenu } }
		allow = { hidden_trigger = { always = no } }
	}

	### Cancel
	option = {
		name = CrisisManagerMenu.7150a1.name
		custom_tooltip = CrisisManagerMenu.7150a1.tooltip
		trigger = { NOT = { has_country_flag = CmtFlagSpMenu } }
		hidden_effect = {
			CmtEffectClearTargetPlayerCrisis = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	option = {
		name = CrisisManagerMenu.7150a2.name
		custom_tooltip = CrisisManagerMenu.7150a2.tooltip
		trigger = { NOT = { has_country_flag = CmtFlagSpMenu } }
		hidden_effect = {
			CmtEffectClearTargetPlayerCrisis = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	option = {
		name = CrisisManagerMenu.7150a3.name
		custom_tooltip = CrisisManagerMenu.7150a3.tooltip
		trigger = { NOT = { has_country_flag = CmtFlagSpMenu } }
		hidden_effect = {
			CmtEffectClearTargetPlayerCrisis = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}

	### Trigger on Us
	option = {
		name = CrisisManagerMenu.7150b.name
		custom_tooltip = CrisisManagerMenu.7150b.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			CmtTriggerPlayerCrisisAggressorCandidateMenu = yes
		}
		hidden_effect = {
			remove_country_flag = CmtFlagNowInMenu
			country_event = { id = CrisisManagerControl.0511 }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis1
			CmtTriggerPlayerCrisisAggressorCandidateMenu = yes
		}
		allow = { hidden_trigger = { always = no } }
	}

	### Trigger on Another Empire
	option = {
		name = CrisisManagerMenu.7150c1.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis1
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis1 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c2.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis2
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis2 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c3.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis3
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis3 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c4.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis4
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis4 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c5.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis5
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis5 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c6.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis6
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis6 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c7.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis7
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis7 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	option = {
		name = CrisisManagerMenu.7150c8.name
		custom_tooltip = CrisisManagerMenu.7150c.tooltip
		trigger = {
			NOT = { has_country_flag = CmtFlagSpMenu }
			exists = event_target:CmtTargetManualPlayerCrisis8
		}
		hidden_effect = {
			country_event = { id = CrisisManagerMenu.0100 }
			event_target:CmtTargetManualPlayerCrisis8 = { country_event = { id = CrisisManagerControl.0511 } }
			CmtEffectClearTargetPlayerCrisis = yes
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

############################################
### Forced Termination of Crisis Country ###
############################################

### Menu
country_event = {
	id = CrisisManagerMenu.7200
	title = CrisisManagerMenu.7200.name
	desc = CrisisManagerMenu.7200.desc
	picture = GFX_evt_CmtMenuA
	is_triggered_only = yes

	### Separator
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			NOT = { has_global_flag = CmtFlagNoSeparator }
		}
		allow = { hidden_trigger = { always = no } }
	}

	### Prethoryn
	option = {
		name = CrisisManagerMenu.7200a.name
		custom_tooltip = CrisisManagerMenu.7200a.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			CmtTriggerExistPrethoryn = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7201 } }
	}

	### Extradimensionals
	option = {
		name = CrisisManagerMenu.7200b.name
		custom_tooltip = CrisisManagerMenu.7200b.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			CmtTriggerExistExds = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7202 } }
	}

	### Contingency
	option = {
		name = CrisisManagerMenu.7200c.name
		custom_tooltip = CrisisManagerMenu.7200c.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			CmtTriggerExistContingency = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7203 } }
	}

	### Forced End of the Cycle.
	option = {
		name = CrisisManagerMenu.7200d.name
		custom_tooltip = CrisisManagerMenu.7200d.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			CmtTriggerExistShroudSpirit = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7204 } }
	}

	### Separator
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			OR = {
				has_global_flag = CmtFlagSleeperEdition
				has_global_flag = CmtFlagMidGameEdition
			}
			NOT = { has_global_flag = CmtFlagNoSeparator }
		}
		allow = { hidden_trigger = { always = no } }
	}

	### Fallen/Awakened Empire
	option = {
		name = CrisisManagerMenu.7200e.name
		custom_tooltip = CrisisManagerMenu.7200e.tooltip
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			any_country = { CmtTriggerIsFallenEmpire = yes }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7205 } }
	}

	### War in Heaven
	option = {
		name = CrisisManagerMenu.7200f.name
		custom_tooltip = CrisisManagerMenu.7200f.tooltip
		trigger = {
			has_global_flag = CmtFlagSleeperEdition
			has_global_flag = war_in_heaven_started
			has_global_flag = war_in_heaven_ongoing
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7206 } }
	}

	### Khan
	option = {
		name = CrisisManagerMenu.7200h.name
		custom_tooltip = CrisisManagerMenu.7200h.tooltip
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			has_global_flag = marauder_crisis_ongoing
			any_country = { CmtTriggerIsKhanCountry = yes }
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7208 } }
	}

	### Gray Tempest
	option = {
		name = CrisisManagerMenu.7200i.name
		custom_tooltip = CrisisManagerMenu.7200i.tooltip
		trigger = {
			has_global_flag = CmtFlagMidGameEdition
			CmtTriggerExistGraygoo = yes
		}
		hidden_effect = { country_event = { id = CrisisManagerMenu.7209 } }
	}

	### Go Back, etc.
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}
	option = {
		name = CmtTextGoBack.name
		custom_tooltip = CmtTextGoBack.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Termination of Prethoryn
country_event = {
	id = CrisisManagerMenu.7201
	title = CrisisManagerMenu.7201.name
	desc = CrisisManagerMenu.7201.desc
	picture = GFX_evt_physics_research
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}
	option = {
		name = CrisisManagerMenu.720xb.name
		custom_tooltip = CrisisManagerMenu.720xb.tooltip
		hidden_effect = {
			CmtEffectDestroyPrethoryn = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of Extradimensionals
country_event = {
	id = CrisisManagerMenu.7202
	title = CrisisManagerMenu.7202.name
	desc = CrisisManagerMenu.7202.desc
	picture = GFX_evt_wormhole
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}
	option = {
		name = CrisisManagerMenu.720xb.name
		custom_tooltip = CrisisManagerMenu.720xb.tooltip
		hidden_effect = {
			CmtEffectDestroyExds = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of Contingency
country_event = {
	id = CrisisManagerMenu.7203
	title = CrisisManagerMenu.7203.name
	desc = CrisisManagerMenu.7203.desc
	picture = GFX_evt_glitchy_matrix
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}
	option = {
		name = CrisisManagerMenu.720xb.name
		custom_tooltip = CrisisManagerMenu.720xb.tooltip
		hidden_effect = {
			CmtEffectDestroyContingency = yes
			# country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of Shroud Spirits (Forced End of the Cycle)
country_event = {
	id = CrisisManagerMenu.7204
	title = CrisisManagerMenu.7204.name
	desc = CrisisManagerMenu.7204.desc
	picture = GFX_evt_unspeakable_horror
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}
	option = {
		name = CrisisManagerMenu.720xb.name
		custom_tooltip = CrisisManagerMenu.720xb.tooltip
		hidden_effect = {
			CmtEffectDestroyShroudSpirits = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of Fallen/Awakened Empire
country_event = {
	id = CrisisManagerMenu.7205
	title = CrisisManagerMenu.7205.name
	desc = CrisisManagerMenu.7205.desc
	picture = GFX_evt_fallen_empire_awakes
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }

	after = {
		hidden_effect = { CmtEffectClearTargetSleepers = yes }
		country_event = { id = CrisisManagerMenu.7200 }
	}

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
	}

	option = {
		name = CrisisManagerMenu.7205c1.name
		custom_tooltip = CrisisManagerMenu.7205c.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper1 } }
		hidden_effect = {
			event_target:CmtTargetManualSleeper1 = {
				if = { limit = { is_country_type = fallen_empire }
					destroy_country = yes
				} else = {
					country_event = { id = CrisisManagerControl.7205 }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7205c2.name
		custom_tooltip = CrisisManagerMenu.7205c.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper2 } }
		hidden_effect = {
			event_target:CmtTargetManualSleeper2 = {
				if = { limit = { is_country_type = fallen_empire }
					destroy_country = yes
				} else = {
					country_event = { id = CrisisManagerControl.7205 }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7205c3.name
		custom_tooltip = CrisisManagerMenu.7205c.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper3 } }
		hidden_effect = {
			event_target:CmtTargetManualSleeper3 = {
				if = { limit = { is_country_type = fallen_empire }
					destroy_country = yes
				} else = {
					country_event = { id = CrisisManagerControl.7205 }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7205c4.name
		custom_tooltip = CrisisManagerMenu.7205c.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper4 } }
		hidden_effect = {
			event_target:CmtTargetManualSleeper4 = {
				if = { limit = { is_country_type = fallen_empire }
					destroy_country = yes
				} else = {
					country_event = { id = CrisisManagerControl.7205 }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7205c5.name
		custom_tooltip = CrisisManagerMenu.7205c.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper5 } }
		hidden_effect = {
			event_target:CmtTargetManualSleeper5 = {
				if = { limit = { is_country_type = fallen_empire }
					destroy_country = yes
				} else = {
					country_event = { id = CrisisManagerControl.7205 }
				}
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of War in Heaven.
country_event = {
	id = CrisisManagerMenu.7206
	title = CrisisManagerMenu.7206.name
	desc = CrisisManagerMenu.7206.desc
	picture = GFX_evt_fallen_empire_awakes
	is_triggered_only = yes

	after = {
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}
	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
	}
	option = {
		name = CrisisManagerMenu.720xb.name
		custom_tooltip = CrisisManagerMenu.720xb.tooltip
		hidden_effect = {
			# country_event = { id = CrisisManagerControl.7206 }
			random_country = {
				limit = {
					CmtTriggerIsHeavenAFE = yes
					is_at_war = yes
					any_country = {
						CmtTriggerIsHeavenAFE = yes
						is_at_war_with = prev
					}
					any_war = {
						is_total_war = yes
						any_war_participant = {
							prev = {
								OR = {
									using_war_goal = { type = wg_war_in_heaven owner = prev }
									using_war_goal = { type = wg_CmtWarInHeaven1 owner = prev }
									using_war_goal = { type = wg_CmtWarInHeaven3 owner = prev }
									using_war_goal = { type = wg_CmtWarInHeaven4 owner = prev }
									using_war_goal = { type = wg_CmtWarInHeaven5 owner = prev }
								}
							}
						}
					}
				}
				country_event = { id = war_in_heaven.10 }
				country_event = { id = war_in_heaven.17 days = 3 }
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of Khan/Marauder
country_event = {
	id = CrisisManagerMenu.7208
	title = CrisisManagerMenu.7208.name
	desc = CrisisManagerMenu.7208.desc
	picture = GFX_evt_khan_throne_room
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { NOT = { exists = event_target:marauder_country_1 } }
			random_country = {
				limit = { has_country_flag = marauder_1 }
				save_global_event_target_as = marauder_country_1
			}
		}
		if = {
			limit = { NOT = { exists = event_target:marauder_country_2 } }
			random_country = {
				limit = { has_country_flag = marauder_2 }
				save_global_event_target_as = marauder_country_2
			}
		}
		if = {
			limit = { NOT = { exists = event_target:marauder_country_3 } }
			random_country = {
				limit = { has_country_flag = marauder_3 }
				save_global_event_target_as = marauder_country_3
			}
		}
	}

	after = {
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
		# legacy
		# if = {
		# 	limit = { exists = event_target:CmtTargetManualMarauder1 }
		# 	clear_global_event_target = CmtTargetManualMarauder1
		# }
		# if = {
		# 	limit = { exists = event_target:CmtTargetManualMarauder2 }
		# 	clear_global_event_target = CmtTargetManualMarauder2
		# }
		# if = {
		# 	limit = { exists = event_target:CmtTargetManualMarauder3 }
		# 	clear_global_event_target = CmtTargetManualMarauder3
		# }
	}

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
	}
	option = {
		name = CrisisManagerMenu.7208b.name
		custom_tooltip = CrisisManagerMenu.7208b.tooltip
		trigger = { any_country = { CmtTriggerIsKhanCountry = yes } }
		hidden_effect = {
			every_country = {
				limit = { CmtTriggerIsKhanCountry = yes }
				country_event = { id = marauder.512 }
				set_country_flag = khan_dead_assassin
				remove_country_flag = khan_dead_poison
				remove_country_flag = khan_dead_disease
				remove_country_flag = khan_dead_concubine
			}
		}
	}

	option = {
		name = CrisisManagerMenu.7208c1.name
		custom_tooltip = CrisisManagerMenu.7208c.tooltip
		trigger = { exists = event_target:marauder_country_1 }
		hidden_effect = {
			event_target:marauder_country_1 = { destroy_country = yes }
			clear_global_event_target = marauder_country_1
		}
	}
	option = {
		name = CrisisManagerMenu.7208c2.name
		custom_tooltip = CrisisManagerMenu.7208c.tooltip
		trigger = { exists = event_target:marauder_country_2 }
		hidden_effect = {
			event_target:marauder_country_2 = { destroy_country = yes }
			clear_global_event_target = marauder_country_2
		}
	}
	option = {
		name = CrisisManagerMenu.7208c3.name
		custom_tooltip = CrisisManagerMenu.7208c.tooltip
		trigger = { exists = event_target:marauder_country_3 }
		hidden_effect = {
			event_target:marauder_country_3 = { destroy_country = yes }
			clear_global_event_target = marauder_country_3
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Termination of Graygoo
country_event = {
	id = CrisisManagerMenu.7209
	title = CrisisManagerMenu.7209.name
	desc = CrisisManagerMenu.7209.desc
	picture = GFX_evt_gray_goo
	is_triggered_only = yes

	option = {
		name = CrisisManagerMenu.720xa.name
		custom_tooltip = CrisisManagerMenu.720xa.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7200 } }
	}
	option = {
		name = CrisisManagerMenu.720xb.name
		custom_tooltip = CrisisManagerMenu.720xb.tooltip
		hidden_effect = {
			event_target:nanite_factory = { save_event_target_as = goo_slayer_ship }
			CmtEffectDestroyGraygoo = yes
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

#################################
### Create Fleet for Sleepers ###
#################################

### Menu
country_event = {
	id = CrisisManagerMenu.7400
	title = CrisisManagerMenu.7400.name
	desc = CrisisManagerMenu.7400.desc
	picture = GFX_evt_fallen_empire
	is_triggered_only = yes

	### Separator
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			has_global_flag = CmtFlagEndGameEdition
			NOT = { has_global_flag = CmtFlagNoSeparator }
		}
		allow = { hidden_trigger = { always = no } }
	}

	### Option
	option = {
		name = CrisisManagerMenu.7400a.name
		custom_tooltip = CrisisManagerMenu.7400a.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7411 } }
	}
	option = {
		name = CrisisManagerMenu.7400b.name
		custom_tooltip = CrisisManagerMenu.7400a.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7412 } }
	}
	option = {
		name = CrisisManagerMenu.7400c.name
		custom_tooltip = CrisisManagerMenu.7400a.tooltip
		trigger = { host_has_dlc = "Apocalypse" }
		hidden_effect = { country_event = { id = CrisisManagerMenu.7413 } }
	}
	option = {
		name = CrisisManagerMenu.7400d.name
		custom_tooltip = CrisisManagerMenu.7400d.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7419 } }
	}

	### Go Back, etc.
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}
	option = {
		name = CmtTextGoBack.name
		custom_tooltip = CmtTextGoBack.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7000 } }
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = { CmtEffectExitMenu = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Create Standard Fleet for Sleeper.
country_event = {
	id = CrisisManagerMenu.7411
	title = CrisisManagerMenu.7411.name
	desc = CrisisManagerMenu.7411.desc
	picture = GFX_evt_fallen_empire
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }

	after = {
		hidden_effect = {
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7400 }
		}
	}

	### Cancel
	option = {
		name = CrisisManagerMenu.741xa.name
		custom_tooltip = CrisisManagerMenu.741xa.tooltip
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Standard Creation
	option = {
		name = CrisisManagerMenu.7411d0.name
		custom_tooltip = CrisisManagerMenu.7411d0.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				every_owned_ship = { limit = { is_ship_class = shipclass_military } delete_ship = this }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411b1.name
		custom_tooltip = CrisisManagerMenu.7411b1.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				random_list = { 10 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } 20 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411b2.name
		custom_tooltip = CrisisManagerMenu.7411b2.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				random_list = { 20 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } 10 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411c1.name
		custom_tooltip = CrisisManagerMenu.7411c1.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = { CmtEffectCreateSleeperStandard = yes }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411c2.name
		custom_tooltip = CrisisManagerMenu.7411c2.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						count = 2
						CmtEffectCreateSleeperStandard = yes
					}
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411c3.name
		custom_tooltip = CrisisManagerMenu.7411c3.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						count = 3
						CmtEffectCreateSleeperStandard = yes
					}
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411c4.name
		custom_tooltip = CrisisManagerMenu.7411c4.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						count = 4
						CmtEffectCreateSleeperStandard = yes
					}
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7411c5.name
		custom_tooltip = CrisisManagerMenu.7411c5.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						count = 5
						CmtEffectCreateSleeperStandard = yes
					}
				}
			}
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Create for Specified Sleeper
	option = {
		name = CrisisManagerMenu.7411e1.name
		custom_tooltip = CrisisManagerMenu.7411e1.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper1 } }
		hidden_effect = { event_target:CmtTargetManualSleeper1 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7411e2.name
		custom_tooltip = CrisisManagerMenu.7411e2.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper2 } }
		hidden_effect = { event_target:CmtTargetManualSleeper2 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7411e3.name
		custom_tooltip = CrisisManagerMenu.7411e3.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper3 } }
		hidden_effect = { event_target:CmtTargetManualSleeper3 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7411e4.name
		custom_tooltip = CrisisManagerMenu.7411e4.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper4 } }
		hidden_effect = { event_target:CmtTargetManualSleeper4 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7411e5.name
		custom_tooltip = CrisisManagerMenu.7411e5.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper5 } }
		hidden_effect = { event_target:CmtTargetManualSleeper5 = { capital_scope = { CmtEffectCreateSleeperStandard = yes } } }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Create Titan for Sleeper
country_event = {
	id = CrisisManagerMenu.7412
	title = CrisisManagerMenu.7412.name
	desc = CrisisManagerMenu.7412.desc
	picture = GFX_evt_fallen_empire
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }

	after = {
		hidden_effect = {
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7400 }
		}
	}

	### Cancel
	option = {
		name = CrisisManagerMenu.741xa.name
		custom_tooltip = CrisisManagerMenu.741xa.tooltip
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Standard Creation
	option = {
		name = CrisisManagerMenu.7412b1.name
		custom_tooltip = CrisisManagerMenu.7412b1.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					NOT = { any_owned_ship = { is_ship_size = massive_ship_fallen_empire } }
				}
				random_list = { 10 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } 30 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412b2.name
		custom_tooltip = CrisisManagerMenu.7412b2.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					NOT = { any_owned_ship = { is_ship_size = massive_ship_fallen_empire } }
				}
				random_list = { 20 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } 30 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412b3.name
		custom_tooltip = CrisisManagerMenu.7412b3.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					NOT = { any_owned_ship = { is_ship_size = massive_ship_fallen_empire } }
				}
				random_list = { 20 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } 10 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412c1.name
		custom_tooltip = CrisisManagerMenu.7412c1.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = { CmtEffectCreateSleeperTitan = yes }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412c2.name
		custom_tooltip = CrisisManagerMenu.7412c2.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						count = 2
						CmtEffectCreateSleeperTitan = yes
					}
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412c3.name
		custom_tooltip = CrisisManagerMenu.7412c3.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						count = 3
						CmtEffectCreateSleeperTitan = yes
					}
				}
			}
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Set for Targeted Number
	option = {
		name = CrisisManagerMenu.7412d0.name
		custom_tooltip = CrisisManagerMenu.7412d0.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				every_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } delete_ship = this }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412d1.name
		custom_tooltip = CrisisManagerMenu.7412d1.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count < 1 } } }
						CmtEffectCreateSleeperTitan = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count > 1 } }
					random_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412d2.name
		custom_tooltip = CrisisManagerMenu.7412d2.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count < 2 } } }
						CmtEffectCreateSleeperTitan = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count > 2 } }
					random_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412d3.name
		custom_tooltip = CrisisManagerMenu.7412d3.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count < 3 } } }
						CmtEffectCreateSleeperTitan = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count > 3 } }
					random_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412d4.name
		custom_tooltip = CrisisManagerMenu.7412d4.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count < 4 } } }
						CmtEffectCreateSleeperTitan = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count > 4 } }
					random_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412d5.name
		custom_tooltip = CrisisManagerMenu.7412d5.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count < 5 } } }
						CmtEffectCreateSleeperTitan = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } count > 5 } }
					random_owned_ship = { limit = { is_ship_size = massive_ship_fallen_empire } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7412d9.name
		custom_tooltip = CrisisManagerMenu.7412d9.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				every_owned_ship = {
					limit = { is_ship_size = massive_ship_fallen_empire }
					delete_ship = this
				}
				every_owned_fleet = {
					limit = {
						is_ship_class = shipclass_military
						count_owned_ship = { limit = { NOT = { is_ship_size = massive_ship_fallen_empire } } count > 1 }
					}
					create_fallen_empire_titan = yes
				}
			}
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Create for Specified Sleeper
	option = {
		name = CrisisManagerMenu.7412e1.name
		custom_tooltip = CrisisManagerMenu.7412e1.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper1 } }
		hidden_effect = { event_target:CmtTargetManualSleeper1 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7412e2.name
		custom_tooltip = CrisisManagerMenu.7412e2.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper2 } }
		hidden_effect = { event_target:CmtTargetManualSleeper2 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7412e3.name
		custom_tooltip = CrisisManagerMenu.7412e3.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper3 } }
		hidden_effect = { event_target:CmtTargetManualSleeper3 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7412e4.name
		custom_tooltip = CrisisManagerMenu.7412e4.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper4 } }
		hidden_effect = { event_target:CmtTargetManualSleeper4 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7412e5.name
		custom_tooltip = CrisisManagerMenu.7412e5.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper5 } }
		hidden_effect = { event_target:CmtTargetManualSleeper5 = { capital_scope = { CmtEffectCreateSleeperTitan = yes } } }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Create Colossus for Sleeper
country_event = {
	id = CrisisManagerMenu.7413
	title = CrisisManagerMenu.7413.name
	desc = CrisisManagerMenu.7413.desc
	picture = GFX_evt_fallen_empire
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }

	after = {
		hidden_effect = {
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7400 }
		}
	}

	### Cancel
	option = {
		name = CrisisManagerMenu.741xa.name
		custom_tooltip = CrisisManagerMenu.741xa.tooltip
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Standard Creation
	option = {
		name = CrisisManagerMenu.7413b1.name
		custom_tooltip = CrisisManagerMenu.7413b1.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					NOT = { any_owned_ship = { is_ship_size = colossus } }
				}
				random_list = { 10 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } 90 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7413b2.name
		custom_tooltip = CrisisManagerMenu.7413b2.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					NOT = { any_owned_ship = { is_ship_size = colossus } }
				}
				random_list = { 10 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } 20 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7413b3.name
		custom_tooltip = CrisisManagerMenu.7413b3.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					NOT = { any_owned_ship = { is_ship_size = colossus } }
				}
				random_list = { 20 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } 10 = {} }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7413c1.name
		custom_tooltip = CrisisManagerMenu.7413c1.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = { CmtEffectCreateSleeperColossus = yes }
			}
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Set for Targeted Number
	option = {
		name = CrisisManagerMenu.7413d0.name
		custom_tooltip = CrisisManagerMenu.7413d0.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				every_owned_ship = { limit = { is_ship_size = colossus } delete_ship = this }
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7413d1.name
		custom_tooltip = CrisisManagerMenu.7413d1.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = colossus } count < 1 } } }
						CmtEffectCreateSleeperColossus = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = colossus } count > 1 } }
					random_owned_ship = { limit = { is_ship_size = colossus } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7413d2.name
		custom_tooltip = CrisisManagerMenu.7413d2.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = colossus } count < 2 } } }
						CmtEffectCreateSleeperColossus = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = colossus } count > 2 } }
					random_owned_ship = { limit = { is_ship_size = colossus } delete_ship = this }
				}
			}
		}
	}
	option = {
		name = CrisisManagerMenu.7413d3.name
		custom_tooltip = CrisisManagerMenu.7413d3.tooltip
		hidden_effect = {
			every_country = {
				limit = { is_country_type = fallen_empire }
				capital_scope = {
					while = {
						limit = { prev = { count_owned_ship = { limit = { is_ship_size = colossus } count < 3 } } }
						CmtEffectCreateSleeperColossus = yes
					}
				}
				while = {
					limit = { count_owned_ship = { limit = { is_ship_size = colossus } count > 3 } }
					random_owned_ship = { limit = { is_ship_size = colossus } delete_ship = this }
				}
			}
		}
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Create for Specified Sleeper
	option = {
		name = CrisisManagerMenu.7413e1.name
		custom_tooltip = CrisisManagerMenu.7413e1.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper1 } }
		hidden_effect = { event_target:CmtTargetManualSleeper1 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7413e2.name
		custom_tooltip = CrisisManagerMenu.7413e2.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper2 } }
		hidden_effect = { event_target:CmtTargetManualSleeper2 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7413e3.name
		custom_tooltip = CrisisManagerMenu.7413e3.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper3 } }
		hidden_effect = { event_target:CmtTargetManualSleeper3 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7413e4.name
		custom_tooltip = CrisisManagerMenu.7413e4.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper4 } }
		hidden_effect = { event_target:CmtTargetManualSleeper4 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } }
	}
	option = {
		name = CrisisManagerMenu.7413e5.name
		custom_tooltip = CrisisManagerMenu.7413e5.tooltip
		trigger = { hidden_trigger = { exists = event_target:CmtTargetManualSleeper5 } }
		hidden_effect = { event_target:CmtTargetManualSleeper5 = { capital_scope = { CmtEffectCreateSleeperColossus = yes } } }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Create Titan for Sleeper
country_event = {
	id = CrisisManagerMenu.7419
	title = CrisisManagerMenu.7419.name
	desc = CrisisManagerMenu.7419.desc
	picture = GFX_evt_fallen_empire
	is_triggered_only = yes

	immediate = { CmtEffectManualTargetSleepers = yes }

	after = {
		hidden_effect = {
			CmtEffectClearTargetSleepers = yes
			country_event = { id = CrisisManagerMenu.7400 }
		}
	}

	### Cancel
	option = {
		name = CrisisManagerMenu.741xa.name
		custom_tooltip = CrisisManagerMenu.741xa.tooltip
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Weak
	option = {
		name = CrisisManagerMenu.7419b1.name
		custom_tooltip = CrisisManagerMenu.7419b1.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					is_at_war = no
				}
				every_owned_ship = {
					limit = {
						OR = {
							is_ship_class = shipclass_military
							is_ship_size = colossus
						}
					}
					delete_ship = this
				}
				capital_scope = {
					CmtEffectCreateSleeperStandard = yes
					CmtEffectCreateSleeperStandard = yes
				}
			}
		}
	}

	### Standard
	option = {
		name = CrisisManagerMenu.7419b2.name
		custom_tooltip = CrisisManagerMenu.7419b2.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					is_at_war = no
				}
				every_owned_ship = {
					limit = {
						OR = {
							is_ship_class = shipclass_military
							is_ship_size = colossus
						}
					}
					delete_ship = this
				}
				capital_scope = {
					CmtEffectCreateSleeperStandard = yes
					CmtEffectCreateSleeperStandard = yes
					random_list = { 10 = { CmtEffectCreateSleeperStandard = yes } 20 = {} }
					random_list = { 10 = { CmtEffectCreateSleeperTitan = yes } 30 = {} }
					if = {
						limit = { host_has_dlc = "Apocalypse" }
						random_list = { 10 = { CmtEffectCreateSleeperColossus = yes } 90 = {} }
					}
				}
			}
		}
	}

	### Always Titan/Collossus
	option = {
		name = CrisisManagerMenu.7419b3.name
		custom_tooltip = CrisisManagerMenu.7419b3.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					is_at_war = no
				}
				every_owned_ship = {
					limit = {
						OR = {
							is_ship_class = shipclass_military
							is_ship_size = colossus
						}
					}
					delete_ship = this
				}
				capital_scope = {
					CmtEffectCreateSleeperStandard = yes
					CmtEffectCreateSleeperStandard = yes
					CmtEffectCreateSleeperStandard = yes
					CmtEffectCreateSleeperTitan = yes
					if = {
						limit = { host_has_dlc = "Apocalypse" }
						CmtEffectCreateSleeperColossus = yes
					}
				}
			}
		}
	}

	### Full Titan/Collossus
	option = {
		name = CrisisManagerMenu.7419b4.name
		custom_tooltip = CrisisManagerMenu.7419b4.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					is_at_war = no
				}
				every_owned_ship = {
					limit = {
						OR = {
							is_ship_class = shipclass_military
							is_ship_size = colossus
						}
					}
					delete_ship = this
				}
				capital_scope = {
					while = {
						count = 3
						CmtEffectCreateSleeperStandard = yes
						last_created_fleet = { create_fallen_empire_titan = yes }
					}
					if = {
						limit = { host_has_dlc = "Apocalypse" }
						CmtEffectCreateSleeperColossus = yes
					}
				}
			}
		}
	}

	### Strong
	option = {
		name = CrisisManagerMenu.7419b5.name
		custom_tooltip = CrisisManagerMenu.7419b5.tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_country_type = fallen_empire
					is_at_war = no
				}
				every_owned_ship = {
					limit = {
						OR = {
							is_ship_class = shipclass_military
							is_ship_size = colossus
						}
					}
					delete_ship = this
				}
				capital_scope = {
					while = {
						count = 5
						CmtEffectCreateSleeperStandard = yes
						last_created_fleet = { create_fallen_empire_titan = yes }
					}
					if = {
						limit = { host_has_dlc = "Apocalypse" }
						CmtEffectCreateSleeperColossus = yes
						CmtEffectCreateSleeperColossus = yes
					}
				}
			}
		}
	}

	### User Template
	option = {
		name = CrisisManagerMenu.7419b9.name
		custom_tooltip = CrisisManagerMenu.7419b9.tooltip
		trigger = { always = @CmtT201_ConstSleeperFleet_Activate }
		hidden_effect = { CmtEffectApplyTemplate201 = yes }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

############################
### Create/Delete L-Gate ###
############################

country_event = {
	id = CrisisManagerMenu.7500
	title = CrisisManagerMenu.7500.name
	desc = {
		text = CrisisManagerMenu.7500.desc1
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value = 0 } } }
	}
	desc = {
		text = CrisisManagerMenu.7500.desc2
		trigger = { NOT = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value = 0 } } } }
	}
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	immediate = {
		event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 0 } }
		every_system = {
			limit = { has_star_flag = CmtFlagListedLgateSystem }
			remove_star_flag = CmtFlagListedLgateSystem
		}
		every_system = {
			limit = { has_star_flag = lgate }
			event_target:CmtGlobalVar = { change_variable = { which = CmtVarManualLgate value = 1 } }
		}
	}

	### Separator
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Create L-Gate
	option = {
		name = CrisisManagerMenu.7500a1.name
		custom_tooltip = CrisisManagerMenu.7500a1.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 1 } }
			country_event = { id = CrisisManagerMenu.7511 }
		}
	}
	option = {
		name = CrisisManagerMenu.7500a2.name
		custom_tooltip = CrisisManagerMenu.7500a2.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 2 } }
			country_event = { id = CrisisManagerMenu.7511 }
		}
	}
	option = {
		name = CrisisManagerMenu.7500a3.name
		custom_tooltip = CrisisManagerMenu.7500a3.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 3 } }
			country_event = { id = CrisisManagerMenu.7511 }
		}
	}
	option = {
		name = CrisisManagerMenu.7500a5.name
		custom_tooltip = CrisisManagerMenu.7500a5.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 5 } }
			country_event = { id = CrisisManagerMenu.7511 }
		}
	}

	### Create L-Gate Near Capital
	option = {
		name = CrisisManagerMenu.7500b1.name
		custom_tooltip = CrisisManagerMenu.7500b1.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7512 } }
	}

	### Separator
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}

	### Delete All L-Gates
	option = {
		name = CrisisManagerMenu.7500c1.name
		custom_tooltip = CrisisManagerMenu.7500c1.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7521 } }
	}

	### Delete Random L-Gate
	option = {
		name = CrisisManagerMenu.7500c2.name
		custom_tooltip = CrisisManagerMenu.7500c2.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7522 } }
	}

	### Delete Selected L-Gate
	option = {
		name = CrisisManagerMenu.7500c3.name
		custom_tooltip = CrisisManagerMenu.7500c3.tooltip
		hidden_effect = { country_event = { id = CrisisManagerMenu.7523 } }
	}

	### Go Back, etc.
	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = { NOT = { has_global_flag = CmtFlagNoSeparator } }
		allow = { hidden_trigger = { always = no } }
	}
	option = {
		name = CmtTextGoBack.name
		custom_tooltip = CmtTextGoBack.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 0 } }
			country_event = { id = CrisisManagerMenu.7000 }
		}
	}
	option = {
		name = CmtTextExit.name
		custom_tooltip = CmtTextExit.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = { set_variable = { which = CmtVarManualLgate value = 0 } }
			CmtEffectExitMenu = yes
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
	abort_effect = { CmtEffectExitMenu = yes }
}

### Create L-Gate
country_event = {
	id = CrisisManagerMenu.7511
	title = CrisisManagerMenu.7511.name
	desc = CrisisManagerMenu.7511.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	after = { hidden_effect = { country_event = { id = CrisisManagerMenu.7500 } } }

	option = {
		name = CrisisManagerMenu.75xxb.name
		custom_tooltip = CrisisManagerMenu.75xxb.tooltip
	}
	option = {
		name = CrisisManagerMenu.75xxc.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		hidden_effect = {
			event_target:CmtGlobalVar = {
				while = {
					limit = { check_variable = { which = CmtVarManualLgate value > 0.5 } }
					change_variable = { which = CmtVarManualLgate value = -1 }
					random_system = {
						limit = { CmtTriggerSpawnableSystem = yes }
						spawn_system = {
							min_distance >= 20
							max_distance <= 50
							initializer = CmtInitManualLgate00
						}
					}
				}
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Create L-Gate near Capital
country_event = {
	id = CrisisManagerMenu.7512
	title = CrisisManagerMenu.7512.name
	desc = CrisisManagerMenu.7512.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	after = { hidden_effect = { country_event = { id = CrisisManagerMenu.7500 } } }

	option = {
		name = CrisisManagerMenu.75xxb.name
		custom_tooltip = CrisisManagerMenu.75xxb.tooltip
	}
	option = {
		name = CrisisManagerMenu.75xxc.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		hidden_effect = {
			capital_scope = {
				spawn_system = {
					min_distance >= 20
					max_distance <= 50
					initializer = CmtInitManualLgate00
				}
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Delete All L-Gates
country_event = {
	id = CrisisManagerMenu.7521
	title = CrisisManagerMenu.7521.name
	desc = CrisisManagerMenu.7521.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	after = { hidden_effect = { country_event = { id = CrisisManagerMenu.7500 } } }

	option = {
		name = CrisisManagerMenu.75xxb.name
		custom_tooltip = CrisisManagerMenu.75xxb.tooltip
	}
	option = {
		name = CrisisManagerMenu.75xxc.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		hidden_effect = {
			every_system = {
				limit = { has_star_flag = lgate }
				CmtEffectDeleteLgateInSystem = yes
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Delete Random L-Gates
country_event = {
	id = CrisisManagerMenu.7522
	title = CrisisManagerMenu.7522.name
	desc = CrisisManagerMenu.7522.desc
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	after = { hidden_effect = { country_event = { id = CrisisManagerMenu.7500 } } }

	option = {
		name = CrisisManagerMenu.75xxb.name
		custom_tooltip = CrisisManagerMenu.75xxb.tooltip
	}
	option = {
		name = CrisisManagerMenu.75xxc.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		hidden_effect = {
			random_system = {
				limit = { has_star_flag = lgate }
				CmtEffectDeleteLgateInSystem = yes
			}
		}
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}

### Delete Selected L-Gates
country_event = {
	id = CrisisManagerMenu.7523
	title = CrisisManagerMenu.7523.name
	desc = {
		text = CrisisManagerMenu.7523.desc1
		trigger = { NOT = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } } } }
	}
	desc = {
		text = CrisisManagerMenu.7523.desc2
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } } }
	}
	picture = GFX_evt_l-gateway
	is_triggered_only = yes

	immediate = {
		CmtEffectManualTargetLgates = yes
	}

	after = {
		hidden_effect = {
			CmtEffectClearTargetLgates = yes
			if = {
				limit = { has_country_flag = CmtFlagSpMenu }
				remove_country_flag = CmtFlagSpMenu
				country_event = { id = CrisisManagerMenu.7523 }
			} else = { country_event = { id = CrisisManagerMenu.7500 } }
		}
	}

	option = {
		name = CrisisManagerMenu.75xxb.name
		custom_tooltip = CrisisManagerMenu.75xxb.tooltip
	}

	option = {
		name = CrisisManagerMenu.7523d.name
		custom_tooltip = CrisisManagerMenu.7523d.tooltip
		trigger = { event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } } }
		hidden_effect = { set_country_flag = CmtFlagSpMenu }
	}

	option = {
		name = CmtTextSeparator.name
		custom_tooltip = CmtTextSeparator.tooltip
		trigger = {
			NOT = { has_global_flag = CmtFlagNoSeparator }
			event_target:CmtGlobalVar = { check_variable = { which = CmtVarManualLgate value > 8 } }
		}
		allow = { hidden_trigger = { always = no } }
	}

	option = {
		name = CrisisManagerMenu.7523c1.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem1 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem1 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c2.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem2 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem2 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c3.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem3 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem3 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c4.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem4 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem4 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c5.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem5 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem5 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c6.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem6 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem6 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c7.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem7 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem7 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	option = {
		name = CrisisManagerMenu.7523c8.name
		custom_tooltip = CrisisManagerMenu.75xxc.tooltip
		trigger = { exists = event_target:CmtTargetManualLgateSystem8 }
		hidden_effect = { event_target:CmtTargetManualLgateSystem8 = { CmtEffectDeleteLgateInSystem = yes } }
	}
	abort_trigger = { NOT = { has_country_flag = CmtFlagNowInMenu } }
}
